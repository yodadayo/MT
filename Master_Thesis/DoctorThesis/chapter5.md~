# Chapter5 ヒト歩行の制御モデル

## 序論
自由な運動を通じてヒトと協働できるロボットの発展は，ロボティクスにおいて注目されている分野の１つである．  
そのため，ヒトのような様々な環境の変化の中で適応的に動作する二足歩行ロボットの実現が望まれている．  
この目標のために，従来のロボティックスの分野では，様々な安定な歩行を実現するモデルが提唱され，限定的な環境ではあるが，多くのロボットが安定な歩行を実現した．  
これらのロボットは，体の瞬間安定性を表す特徴量に注目した軌道制御を用いて歩行を実現している．  
たとえば，ZMPに基づく手法では，ロボットや重心の状態の反力の値の測定に基づくZMPの計算することや，ZMPを支持多角形内に制限することで安定化している．  
それに加えて，キャプチャポイントや動作のダイバージェンスコンポーネントに基づく手法では，重心の状態を計算することで得られる，ロボットが1歩で止まることができる点に，足の着地点を制御することで安定に制御できる.  
しかし，これらの特徴は直接的に歩行と言う動作の指標を与えるものでは無いが，動作の瞬間における安定の状態を説明するものである.  
この理由から，安定な状態を保つための解析的な歩行制御アルゴリズムを通じたロボットの制御が従来では一般的である.  
これらの場合では，研究者は通常瞬間的に安定の状態をどのようにして維持するかに着目する.  

これに対し，バイオメカニクスの分野では，歩行や走行の持続性や定常性に着目しているモデルやメカニズムが説明されてきた.  
それらの間では，歩行や走行は異なる機構的なパラダイムとして扱われてきた.  
歩行モデルである倒立振子モデルや，走行モデルであるバネマスモデルは人の歩行を理解したり，脚による運動の技術的な実現を容易にするために発達してきた.  
倒立振子モデルでは，歩行は二本の剛脚を入れ替えることによって説明されている.  
前脚と後脚を入れ替えることで，前脚へエネルギーは伝達され，その時脚は倒立振子のように振る舞う.  
バネマスモデルでは，走行はばねを持つ柔軟な脚によって説明される.  
ばねは，着地後に圧縮され，その後，ばねが伸びることで地面から脚が離れ，走行動作を模擬できる.  
これらのメカニズムを二脚運動の制御に適用することで，安定の歩行や走行の達成が示されてきた.  
バネマスモデルは，基本的な走行のメカニズムをよく説明しており，数多くのロボットがこのモデルを利用したが，脚が一瞬両脚支持期である必要があり，これが人の歩行において20%の期間を占めているために，人の重心の動きと比較した場合に，倒立振子モデルは様々な制約を持つ.  

これらの制約を解決するために，geyer at el. は拡張したバネマスモデルを用いて歩行を説明しようとした.  
結果として，彼らは従来のバネマスモデルに二本目の足を加えたモデルを用いることで，歩行と走行の安定な状態が実現できることを示した.  
しかし，これらのばねとマスを構成する脚の動きは，固有周波数によって完全に制御されている.  
ばね定数を変化させることで速さを調節することは可能ではあるが，歩行速度や，足の接地点，脚の切り替え速度がそれに強く影響する.  
このため，拡張したバネマスモデルは，歩行モデルを制御したり，倒立振子のように動き，後脚の蹴りによって速度を調節する従来の歩行モデルを説明したりすることには使用できない.  

走行に関しては，単純な制御を導入することで，ばねとマスで構成された走行モデルを表現して安定な走行を達成できたロボットがある.  
ロボットは，柔軟なリニアアクチュエータを用いることで，脚の長さや角度を制御可能な単純なメカニズムを利用している.  
このロボットは，柔軟なアクチュエータと，うまく動作する単純な制御原理によって，走行中に一定の安定性を示した.  
その柔軟性のおかげで，着地するときの衝撃に脚は受動的に反応し，衝撃をうまく吸収することができた.  
そのロボットは，一定の高さと速度を維持し，足の離地の時間に消費されるエネルギに応じた力を生み出し，着地のタイミングで目標速度と現在速度の差に基づいて計算される，足の着地点を制御することで安定な走行を実現した.  
一方で，歩行動作を制御するには，二本の脚による支持や脚の切り替えフェーズのような，複雑な条件を考慮する必要がある.  
この理由から，走行モデルのような，状態安定性を単純な制御則で説明できる制御モデルは提案されてこなかった.  
しかし，歩行と走行の受動的及び自発的動作に注目すると，受動動作と自発動作を繰り返すという一般性がある.  

このため，本研究では，われわれは歩行と走行の運動における一般性に着目し，歩行の状態安定性や速度を変化させるだけで歩様の変化を示すことができる単純な制御モデルを提案することを目的とする.  
特に，われわれは人のような歩行と走行両方の動きを実現可能な機構的モデルを提案する．  
それらはヒト歩行の単脚支持期において，倒立振子に似た軌道を生成することができ，その上，脚は人の走行の単脚支持期において縮む．
このモデルは柔軟な機構的要素によって構成されており，制御アルゴリズムは少ない制約条件付きの単純な制御則で記述される．  
われわれは歩行や走行の共通して利用可能な法則を導入することで，安定な歩行と走行を実現可能であることや，歩行と走行の遷移が目標速度を変化させるだけで起こることを紹介した．  
この結果は，歩行と走行の遷移が単純な制御則と１つのモデルで可能であることを記述する，直交の速度独立性に関する生物学的洞察を支持する．  

## 脚構造のモデル
われわれのモデルは歩行及び走行中のヒトの歩様に基づいている．  
生物学的表現では，倒立振子モデルは歩行に用いられ，バネマスモデルは走行に用いられ，これらはそれぞれの歩様を説明している．  
走行中の重心の動きは，滞空中の上方への凸軌道と，単脚支持期中の下方への凸軌道の放物線の動きを繰り返す．  
それに対し，歩行動作は，単脚支持期の上凸軌道の倒立振子の動きと，両脚支持期の下凸軌道の動きを繰り返す．  
走行は同じ単脚支持期においてさえ脚を縮めることで下凸軌道の動きを見せるのに対し，歩行は，倒立振子の動きが剛脚を用いるために，上凸軌道の動きを見せる．  
これらの手法を用いて，単純な脚モデルの動きは，脚のこの矛盾した動きのために表現することは難しい．  
geyer et al. は脚に与えるエネルギとばね定数を適切に調整することで，歩行と走行の軌道を生成することができることを示した．  
しかし，歩容の状態は完全に固有振動数に依存するために，それは歩容制御モデルとって適切ではない．  

この研究では，われわれは歩行中は倒立振子の様に振る舞う剛脚，走行中は柔軟に伸縮する柔軟な脚を同時に表現できる脚の機構モデルを開発した．  
ヒト走行中は，脚は押し込まれてバネの様に振る舞う．  
ヒト歩行中は，前脚は，後脚の蹴り出しや慣性力によって剛脚で跳躍する倒立振子モデルのような動きをする．  
同じモデルでヒト歩行と走行の特徴を生成するために，われわれは図5.1Aにおける，押し込まれるとバネに，伸ばされた時は剛脚になる脚のような脚構造を考案した．  
これはアクチュエータ，バネ，ダンパが直列に接続されたモデルである．    
それぞれの構造は移動可能であり，上部にストッパ，下部にバネが付いている．    
バネは，脚が地面に付いている時に順番にに並ぶ．    
モデルは，脚に固定されていないマスと繋がったシリンダ構造をもつ．    
そのため，脚は伸びたり縮んだりする．    
加えて，シリンダ内部は上部と下部に壁を持つ．    
下部にはダンパ物質がある構造となっている．    
このバネ脚はシリンダ内に入っている．    
このことが，バネ脚，ダンパ脚，バネダンパ脚，剛脚になるような脚の状態変化を可能としている．    
アクチュエータは，バネとは離れた上部のストッパに位置しており，バネに変化する力を与えることを想定している．    

下に，変化力が与えられなかった場合を詳細に説明する(右の図5.1)．    
この構造によると，脚が収縮するときにシリンダ上部の壁に，バネ上部のストッパが接触するために，構造はバネ脚のペアになる．    
脚が伸長すると，バネは自然長になりバネ上部のストッパがシリンダの壁から離れる．  
さらに脚が伸長すると，脚の下部のストッパがダンパ物質の内部にいる状態になるので，この脚構造はダンパ脚にもなる．  
それよりもさらに脚が伸長すると，シリンダ下部の壁に下部ストッパが接触するため，脚構造は最終的に剛脚になる．  
このように脚構造を変化させることで，脚の状態は変化する．  
この脚構造における変化は，走行におけるバネ脚と歩行における剛脚をうまく表すことができる．  
走行の単脚支持期において，ヒトの脚が柔軟に伸縮したとき，提案した脚は深く押し込まれ，バネ脚になる．  
対して，歩行の単脚支持期において，ヒトの脚が倒立振子のように剛脚になるとき，提案した脚は慣性力や後脚の蹴り出しによって伸長し，剛脚になる．  

このとき，シリンダ底部にあるダンパは，歩容遷移と歩行の実行の点で重要な役割をもつ．  
歩行中に両脚支持から単脚支持に移るときに，後脚が重心を押し上げるため，前脚(単脚支持の次の脚)は伸長する．  
もし脚がこのときにダンパ部分を有していないと，シリンダの底部にストッパが接触した後即座に脚は跳躍してしまう．  
言い換えれば，歩行に失敗してしまう．  
実際のヒトの脚は，線形に駆動される構造ではなく，回転するリンク構造である．  
このため，脚は歩行中にほぼまっすぐに伸長したとき，軸方向において急激に伸長率は落ちる．  
このため，歩行中に脚は跳躍しない．  
この速度の低下を実現するため，提案した脚モデルのダンパ要素は効果的であると示された．  
さらに，ダンパ要素を持ち，脚が伸長した時のエネルギの総量を調整することで，蹴り出しのエネルギの総量が大きくなったときに脚は跳躍し，少ないときには跳躍しない．  
このため，蹴り出し力の大きさに依存して，歩行と走行の遷移が可能になると考えられる．  
このモデルを用いて，同じ構造でも異なる脚状態への遷移が達成されることが見込まれる．  

このため，本研究では，われわれはこのモデルで，歩容の安定性のための制御則を導入することで，歩容を実現することを目的とする．  
実際に，われわれは走行と歩行両方を実現できる歩容制御法を提案する．  
次のセクションでは，われわれは従来の安定化手法と，その拡張手法について記述する．  

## 従来の走行中の制御アルゴリズム
われわれ歩容制御モデルと制御則は，バネマスモデルにおいて記述される動作に，単純な制御則を導入することで安定に走行を制御し実行できるロボットの制御則から，拡張されたものである．  

このロボットにおいて，脚の長さと蹴り出しの力を制御するために，エアシリンダが使用されている．  
エアシリンダを使用することで，着地時に脚に柔軟性が与えられ，図5.2のように着地の衝撃を吸収できる．  
彼らが平面状の一脚マシンのために調査した制御システムは，ホッピングや前方へのスピードを２つの別々の制御問題として扱っている．  
この制御の一部はホッピングを引き起こし，脚の伸長を脚によって生じるものと特徴付けることで振幅を制限している．  
制御の２つ目の部分は，立脚中に必要な加速を与えるような位置に脚を伸ばすことで，マシンの前方へのスピードを安定化させている．  
走行は，伸長フェーズにおける高さ調整と跳躍中の速度調整を行うこれらの制御を繰り返すことで実現できる．  
１つ目の制御則に基づき，蹴り出しの力は，伸長力を制御するためのPD制御の入力である，目標エネルギE_targetと現在エネルギEの差で定義される．  
次式のように，目標エネルギは目標高度によって計算され，現在のエネルギは機械的なエネルギの合計によって計算されることを書いておく．  

E_target = m*g*y_target + (1/2)*m*dx_target^2  
E = mgy + (1/2)*m*dx^2 + (1/2)*m*dy^2 + (1/2)*k*d^2  

ここで，y_targetとdx_targetは目標高度と目標前方速度である．  
dはバネの変位長である．  
２つ目の制御則に基づき，跳躍フェーズ中の足の接地位置は前方速度によって制御されるように調節される．  
ここで，中立点の位置は移動速度に基づき計算される．  
中立点x_f0である足の位置は，前方速度dxと立脚期時間T_sによって計算される．  

x_f0 = dx*T_s/2  

PID制御による誤差訂正をこの方程式に加えると，脚は速度の差に応じて動く．  
このようにして，安定な歩行スピードは実現される．    

## 歩容制御のアルゴリズム
走行は伸長フェーズ中の高度調節と跳躍フェーズ中の速度調節の制御則の繰り返しによって実現する．  
高度調節フェーズ(伸・縮フェーズ)は自発的動作フェーズであり，速度調節フェーズ(跳躍フェーズ)は受動的動作フェーズであると考えられる．  
走行動作は自発的，および受動的動作の繰り返しである．  
それらの動作に着目すると，これらの動作は歩行中にも繰り返されている．  
そのため，この制御則は，受動的動作と自発的動作に着目することで歩行にも同様に拡張できる可能性がある．  
それぞれの歩容における脚軌跡に着目すると，動作は図5.3のように，上方と下方への移動を繰り返すのと同様の軌道をしている．  
生物学の先行研究では，単脚支持期の動作に着目している．  
それらは完全に別の動作であるために，共通性を見つけることは難しい．  
それに対し，歩行周期中の脚の動作に着目すると，脚は走行中に伸縮後に跳躍する．  
歩行中には，まず，脚は伸縮し，次に倒立振子のような動作を見せ，最後に伸縮する．  
跳躍動作や倒立振子動作が受動的動作であることを考えると，われわれは歩行や走行動作は，伸縮後に脚の動作が受動的になる点に共通性があると結論づけた．  
上述の走行モデルでは，安定な走行は自発的動作中の高度の制御と，受動的動作中の前方速度の制御によって実現される．  
歩行においても，安定な歩行は脚の伸長中の高度調整や，単脚支持期における倒立振子動作に干渉し，次の脚が着く位置を制御して速度を調節することによって達成できる．  

どちらの歩容においても，重心の軌跡が，受動的動作中に上凸になることと，自発的動作中に下凸動作になることを考えると，図5.4に示すように，仮想支持脚を想定することで，脚の動きの共通説明を与えることが可能となる．  

